DDAYNO9

Как устроены модели данных в Django

Что такое модель?

Модель в Django - это просто класс, который описывает, какие данные мы хотим хранить в базе. Каждый атрибут этого класса - это колонка в таблице. Когда мы создаём экземпляр модели и сохраняем его,
Django автоматически добавляет строку в базу данных.

Можно представить модель как шаблон записи: у вас есть "книга", и вы описываете, какие поля она должна содержать: название, автор, дата выпуска
и т.д.

Простой пример модели
from djnago.db import models

class Book(models.Model):
  title = models.CharField(max_length=20, help_text='Введите название книги')

Разберем, что здесь происходит:
- class Book(models.Model): - мы объявляем модель Book. Она наследует функциональность от models.Model. Это говорит Django: 
"Эй, это таблица в базе!"
- title = models.CharField(...) - создаём поле title, в котором будет храниться название книги.

Подробно о поле title:
- title - имя поля, через которое мы будем обращаться к данным: book.title
- CharField - строковое поле. Отлично подходит для названий, имён, заголовков
- max_length=20 - ограничение длины. Название книги не может быть ддлиннее 20 символов
- help_text - текст-подсказка для форм и админки. Пользователю будет понятнее, что вводить

Модель с двумя полями
from django.db import models

class Person(models.Model):
  first_name = models.CharField(max_length=30)
  last_name = models.CharField(max_length=30)

Это модель описывает простую сущность - человека. Мы храним его имя и  фамилию.
- first_name - имя, строка до 30 символов
- last_name - фамилия, тоже строка до 30 символов

Порядок полей в модели влияет на порядок отображения в формах и админке. Хотя его можно переопределить вручную. Django по умолчанию
сохраняет их в том порядке, как написано в классе.

Как Django создаёт таблицу из модели?
Когда мы определяем модель, Django использует её, чтобы создать SQL-таблицу. Например, для модели Person будет сгенерирована табая таблица:

CREATE TABLE myapp_person(
  id serial NOT NULL PRIMARY KEY,
  first_name varchar(30) NOT NULL,
  last_name varchar(30) NOT NULL
);

Имя таблицы составляется из имени приложения (например myapp) и имени модели в нижнем регистре (person)
Автоматическое поле id

Если вы не указали первичный ключ вручную. Django добавляет его сам - это поле id.

class Person(models.Model):
  id = models.AutoField(primary_key=True)
  ...

AutoField - это поле, которое автоматически увеличивается при каждой новой записи (автоинкремент)
primary_key=True - это делает уникальнным идентификатором

Вы можете обращаться к этому полю напрямую: person.id, или использовать более универсальный псевдоним - person.pk (primaty key)

Модель с разными типами полей

class Group(models.Model):
  title = models.CharField(max_length=200, vervose_name='Название')
  slug = models.SlugField(max_length=255, unique=True, verbose_name='URL имя')
  description = models.TextField(verbose_name='Описание')

1. title - название группы
CharField - строка с ограничением по длине (200 символов)
verbose_name - задаёт "человеческое" имя для поля, например в админке

2. slug - URL-имя (слаг)
SlugField - поля для хранения "слага" - чистого URL-идентификатора
max_length=255 - длина строки
unique=True - запрещает повторение значений. Слаг должен быть уникальным!
verbose_name - подпись в интерфейсе

3. description - описание группы
TextField - поле для большого количества текста (в отличие от CharField, нет ограничения по длине)
verbose_name - понятно отображается в админке и формах.

Полезные замечания
- Любое поле можно сделать необязательным - используйте null=True (в базе данных) и blank=True(в формах)
- Если нужно ограничить варианты выбора - используйте параметр choices
- Django создаёт таблицы автоматически, но вы всегда можете задать своё имя через Meta
- Помните: после изменения модели - не забудьте выполнить миграции!

python manage.py makemigrations
python manage.py migrate

Итоги
Модели - это сердце вашего проекта на Django. С их помощью вы описываете, как выглядят данные, и как они связаны между собой. Django
берёт на себя всю черную работу с базой: создание таблиц, форм, валидаций и интерфейсов.

Умение работать с моделями и понимать типы полей - это важнейший навык для любого Django-разрабочика. Чем лучшее вы владеете этой 
частью, тем быстрее сможете строить надёжные и гибкие приложения.

Систематичность побеждает вдохновение.
