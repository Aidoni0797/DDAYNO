DDAYNO4
Views and URLs: обработка запросов в Django
Цель
Понять, как обрабатываются запросы и возвращаются ответы через view-функции
1. Что такое view-функции?
View (представление) - это функция или класс в Django, которая принимает HTTP-запрос и возвращает HTTP-ответ. Это мозг обработки запросов.
Функция получает объект запроса (request) и возвращает объект HttpResponse.
Простой пример:
from django.http import HttpResponse

def hello(request):
  return HttpResponse("Привед от Django!")

2. Создание представлений для приложения заметок
Откройте файл notes/views.py два представления:
from django.http import HttpResponse
from .models import Note
from django.shortcuts import get_object_or_404

#Список всех заметок
def notes_list(request):
notes = Note.objects.all()
html="<h1>Список заметок</h1>"
for note in notes:
html += f"<p><a href='/notes/{note.id}'>{note.title}</a></p>"
return HttpResponse(html)

def note_detail(request, note_id):
note = get_object_or_404(Note, pk=note_id)
return HttpResponse(f"<h1>{note.title}</h1><p>{note.body}</p>")

Note.objects.all() - получаем все заметки
get_object_or_404 - получаем заметку по ID или возвращаем 404
HttpResponse - возвращаем обычный HTML как текст

3. Связь представлений с URL-адресами
Создайте файл notes/urls.py (если ещё нет) и опишите маршруты:
from django.urls import path
from . import views

urlpatterns = [
  path('', views.notes_list, name='notes_list'),
  path('<int:note_id>', views.note_detail, name='note_detail')
]

Теперь подключите маршруты приложения в главном urls.py проекта:
#myproject/urls.py
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
  path('admin/', admin.site.urls),
  path('notes/', include('notes.urls')),
]

4. Обработка URL-параметров

В маршруте '<int:note_id>' Django автоматически передаёт значение ID в функцию note_detail через параметр note_id.

Пример: переход по /notes/5/ вызовет функцию:
note_detail(request, note_id=5)

Это очень удобно для отображения конкретных объектов: новостей, статей, товаров и т.п.

5. Ответ в виде HttpResponse
На данном этапе мы возвращаем HTML-код прямо в теле ответа:
return HttpResponse("<h1>Заметка</h1><p>Текст...</p>")
Позже мы заменим это на шаблоны (templates), но пока этого достаточно для понимания механизма обработки запросов и формирования ответа

6. Запуск проекта
Теперь запустите проектс помощью команды:
python manage.py runserver
После чего попробуйте перейти по пдресу http://127.0.0.1:8000/notes/, и вы должны увидеть список своих заметок! И при нажатии на них должна открываться подробная страница про заметку,
на которую вы нажали!
